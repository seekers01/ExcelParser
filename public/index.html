<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Excel Javascript</title>
    <link rel="stylesheet" type="text/css" href="../lib/bootstrap/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="../lib/bootstrap/dist/css/bootstrap.min.css.map"/>

    <script lang="javascript" src="../lib/jquery/dist/jquery.min.js"></script>
    <script lang="javascript" src="../lib/bootstrap/dist/js/bootstrap.min.js"></script>
    <script lang="javascript" src="../lib/angular/angular.min.js"></script>
    <script lang="javascript" src="../lib/js-xlsx/dist/xlsx.core.min.js"></script>

    <script src="../lib/d3/d3.js"></script>
    <script src="../lib/nvd3/build/nv.d3.js"></script>
    <!-- or use another assembly -->
    <script src="../lib/angular-nvd3/dist/angular-nvd3.js"></script>
    <link rel="stylesheet" href="../lib/nvd3/build/nv.d3.css">

    <script lang="javascript" src="script.js"></script>
    <link rel="stylesheet" href="style.css"/>
</head>
<body data-ng-app="ExcelParser" data-ng-controller="MainCtrl">
<div class="container-fluid">
    <div class="row">
        <div class="col-lg-12 col-lg-offset-1" data-ng-init="loadFile()">
            <div class="row">
                <div class="col-lg-5">
                    <label for="sample">Choose Sample Number: </label>
                    <select id="sample" name="sample" data-ng-model="selectedSample" data-ng-change="loadHouseDetails()"
                            data-ng-options="idx as ('House ' + idx) for (idx, choice) in houseDetails">
                        <option value="">----Please select a sample---</option>
                    </select>
                </div>

                <div class="col-lg-3">
                    <span class="btn" data-ng-class="{'summer': 'btn-success', 'winter': 'btn-default'}[currentCycle]"
                          data-ng-click="changeCycle('summer')">Summer</span>
                    <span class="btn" data-ng-class="{'winter': 'btn-success', 'summer': 'btn-default'}[currentCycle]"
                          data-ng-click="changeCycle('winter')">Winter</span>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-6">
            <table class="table table-bordered table-striped">
                <caption>House Sample Details</caption>
                <tbody>
                <tr data-ng-repeat="fields in houseDetailsFields">
                    <td><strong>{{fields.display}}</strong></td>
                    <td>{{currentHouseDetails[fields.id]}}</td>
                </tr>
                </tbody>
            </table>
            <table class="table table-bordered table-striped">
                <caption class="capitalize">
                    Appliance List for {{currentCycle}}
                    <span class="pull-right">
                        <input type="checkbox" name="optional" data-ng-model="optional"
                               data-ng-change="optionalChanged()"> Include Optional</span>
                    </span>
                </caption>
                <thead>
                <tr>
                    <th>Appliance</th>
                    <th>Usage (Hrs)</th>
                    <th>Average Power(Kw/Min)</th>
                    <th>Usage (KwH)</th>
                </tr>
                </thead>
                <tbody>
                <tr data-ng-repeat="appliance in currentApplianceList">
                    <td>{{appliance.name}}</td>
                    <td>{{appliance.hoursUsed}}</td>
                    <td>{{appliance.avgPowerForDevice}}</td>
                    <td>{{appliance.hoursUsed * (appliance.avgPowerForDevice / 60)}}</td>
                </tr>
                </tbody>
            </table>

            <table class="table table-bordered table-striped" data-ng-if="optional">
                <caption class="capitalize">Optional Devices</caption>
                <thead>
                <tr>
                    <th>Appliance</th>
                    <th>Usage (Hrs)</th>
                    <th>Average Power(Kw/Min)</th>
                    <th>Usage (KwH)</th>
                </tr>
                </thead>
                <tbody>
                <tr data-ng-repeat="optionalAppliance in optionalDevices">
                    <td>{{optionalAppliance.name}}</td>
                    <td>{{optionalAppliance.hoursUsed}}</td>
                    <td>{{optionalAppliance.avgPowerForDevice}}</td>
                    <td>{{optionalAppliance.hoursUsed * (optionalAppliance.avgPowerForDevice / 60)}}</td>
                </tr>
                </tbody>
                </thead>
            </table>
        </div>

        <div class="col-lg-6">
            <div class="row">
                <div class="col-lg-12" ng-if="applianceGraph=='HRS'">
                    <div class="alert alert-success">
                        Appliance Usage(Hrs)
                        <u class="cursor pull-right" data-ng-click="showPercentageGraph()">Percentage Usage Graph</u>
                    </div>
                    <nvd3 data="deviceChartData.hourSeries"
                          id="deviceData1"
                          options="options">
                        <svg height="350"></svg>
                    </nvd3>
                </div>
                <div class="col-lg-12" ng-if="applianceGraph=='KWH'">
                    <div class="alert alert-success">
                        Appliance Usage(KwH)
                        <u class="cursor pull-right" data-ng-click="showHoursGraph()">Hour Usage Graph</u>
                    </div>
                    <nvd3 data="deviceChartData.percentageSeries"
                          id="deviceData2"
                          options="options">
                        <svg height="350"></svg>
                    </nvd3>
                </div>
            </div>

            <table class="table table-bordered table-striped">
                <caption>Global Datapoints</caption>
                <tbody>
                <tr data-ng-repeat="fields in globalDetailsFields">
                    <td><strong>{{fields.display}}</strong></td>
                    <td>{{fields.value}}</td>
                </tr>
                </tbody>
            </table>

            <table class="table table-bordered table-striped">
                <caption>Sample Datapoints</caption>
                <tbody>
                <tr data-ng-repeat="fields in sampleDetailsFields">
                    <td ng-if="fields.visible"><strong>{{fields.display}}</strong></td>
                    <td ng-if="fields.visible">{{fields.value}}</td>
                </tr>
                </tbody>
            </table>
        </div>

    </div>
</div>
</body>
</html>